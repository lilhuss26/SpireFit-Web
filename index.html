<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpireFit - Data Collection</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #2e7d32, #4caf50);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 600px;
            width: 100%;
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            position: relative;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            max-width: 150px;
            height: auto;
            margin-bottom: 20px;
            border: 2px solid #4caf50;
            border-radius: 10px;
            padding: 5px;
            background: white;
        }
        
        .social-links {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        
        .facebook-icon {
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: transform 0.3s ease;
            background: #3b5998;
            padding: 8px;
            border-radius: 50%;
        }
        
        .facebook-icon:hover {
            transform: scale(1.1);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
            color: #2e7d32;
            font-size: 2.2em;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2e7d32;
        }
        
        input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e8f5e8;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input:focus {
            outline: none;
            border-color: #4caf50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        button:hover {
            background: linear-gradient(135deg, #45a049, #1b5e20);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        #message {
            margin-top: 20px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .success {
            background-color: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .instructions {
            background-color: #f1f8e9;
            padding: 15px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 14px;
            border-left: 4px solid #4caf50;
        }
        
        .instructions h3 {
            margin-bottom: 10px;
            color: #2e7d32;
        }
        
        .instructions ol {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .instructions code {
            background-color: #e8f5e8;
            padding: 2px 5px;
            border-radius: 3px;
            color: #2e7d32;
        }
        
        .cors-fix {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="social-links">
            <a href="https://www.facebook.com/profile.php?id=61579611306232&rdid=Gzss4BDjCM4FwH73&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1VDZaUwm3r%2F" target="_blank">
                <svg class="facebook-icon" viewBox="0 0 24 24" fill="white">
                    <path d="M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 21.96V14.96H7.9V12.06H10.44V9.85C10.44 7.34 11.93 5.96 14.22 5.96C15.31 5.96 16.45 6.15 16.45 6.15V8.62H15.19C13.95 8.62 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.96H13.56V21.96C18.34 21.21 22 17.06 22 12.06C22 6.53 17.5 2.04 12 2.04Z" />
                </svg>
            </a>
        </div>
        
        <div class="header">
            <div class="logo">SpireFit Logo</div>
            <h1>Join SpireFit Community</h1>
        </div>
        
        <form id="dataForm">
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required placeholder="Enter your name">
            </div>
            
            <div class="form-group">
                <label for="number">Phone Number:</label>
                <input type="tel" id="number" name="number" required placeholder="Enter your phone number">
            </div>
            
            <button type="submit" id="submitBtn">
                Submit to Google Sheets
            </button>
        </form>
        
        <div id="message"></div>
        
        <div class="cors-fix">
            <h3>CORS Solutions Implemented</h3>
            <p>This form now tries direct connection first, then falls back to a proxy if needed. For best performance, update your Google Apps Script:</p>
            <p>Replace your current script with this version:</p>
            <pre><code>function doPost(e) {
  try {
    // Set CORS headers
    var response = ContentService.createTextOutput();
    response.append(JSON.stringify(e));
    
    // Set CORS headers to allow requests from any origin
    response.setMimeType(ContentService.MimeType.JSON);
    response.setHeaders({
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type'
    });
    
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('SpireFit') || 
                SpreadsheetApp.getActiveSpreadsheet().getSheets()[0];
    
    var data = JSON.parse(e.postData.contents);
    sheet.appendRow([data.name, data.number, new Date()]);
    
    return response;
  } catch (error) {
    var errorResponse = ContentService.createTextOutput(JSON.stringify({error: error.message}));
    errorResponse.setMimeType(ContentService.MimeType.JSON);
    errorResponse.setHeaders({
      'Access-Control-Allow-Origin': '*',
      'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',
      'Access-Control-Allow-Headers': 'Content-Type'
    });
    return errorResponse;
  }
}

// Handle preflight OPTIONS request
function doOptions() {
  var output = ContentService.createTextOutput('');
  output.setHeaders({
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',
    'Access-Control-Allow-Headers': 'Content-Type'
  });
  return output;
}</code></pre>
        </div>
    </div>

    <script>
        // Replace this with your Google Apps Script Web App URL
        const scriptURL = 'https://script.google.com/macros/s/AKfycbw5D4_YQF5DJOOGZkpM8d_cZDnHZlmGNNYycK9aAbrP_SaBucu2LQ0nQtMVVXV3cyRsWw/exec';
        
        const form = document.getElementById('dataForm');
        const messageDiv = document.getElementById('message');
        const submitBtn = document.getElementById('submitBtn');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('name').value;
            const number = document.getElementById('number').value;
            
            // Show loading state
            submitBtn.innerHTML = '<span class="loading"></span> Submitting...';
            submitBtn.disabled = true;
            
            try {
                // Try direct request first (if CORS is fixed on server)
                let response;
                try {
                    response = await fetch(scriptURL, {
                        method: 'POST',
                        mode: 'cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            name: name,
                            number: number
                        })
                    });
                } catch (corsError) {
                    // Fallback to proxy if CORS fails
                    console.log('Direct request failed, using proxy...');
                    const proxyURL = 'https://api.allorigins.win/raw?url=';
                    response = await fetch(proxyURL + encodeURIComponent(scriptURL), {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            name: name,
                            number: number
                        })
                    });
                }
                
                const result = await response.json();
                
                if (response.ok) {
                    showMessage('Data successfully submitted to Google Sheets!', 'success');
                    form.reset();
                } else {
                    throw new Error(result.error || 'Server responded with an error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Error: ' + error.message + '. Please check the console for details.', 'error');
            } finally {
                submitBtn.innerHTML = 'Submit to Google Sheets';
                submitBtn.disabled = false;
            }
        });
        
        function showMessage(text, type) {
            messageDiv.textContent = text;
            messageDiv.className = type;
            messageDiv.style.display = 'block';
            
            // Hide message after 5 seconds
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>